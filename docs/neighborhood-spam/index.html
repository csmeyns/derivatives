<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Skip to main content Advertisement SpringerOpen Search Get published Explore Journals Books About Login
Journal of Internet Services and Applications a Springer Open Journal About Articles Submission Guidelines Research Open Access
Published: 11 May 2015 Neighborhoods and bands: an analysis of the origins of spam
Osvaldo Fonseca1*, Elverton Fazzion1, Pedro Henrique B Las-Casas1, Dorgival Guedes1, Wagner Meira Jr1, Cristine Hoepers1, Klaus Steding-Jessen2 &amp; Marcelo HP Chaves2 Journal of Internet Services and Applications volume 6, Article number: 9 (2015) Cite this article">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="Neighborhoods and bands: an analysis of the origins of spam" />
<meta property="og:description" content="Skip to main content Advertisement SpringerOpen Search Get published Explore Journals Books About Login
Journal of Internet Services and Applications a Springer Open Journal About Articles Submission Guidelines Research Open Access
Published: 11 May 2015 Neighborhoods and bands: an analysis of the origins of spam
Osvaldo Fonseca1*, Elverton Fazzion1, Pedro Henrique B Las-Casas1, Dorgival Guedes1, Wagner Meira Jr1, Cristine Hoepers1, Klaus Steding-Jessen2 &amp; Marcelo HP Chaves2 Journal of Internet Services and Applications volume 6, Article number: 9 (2015) Cite this article" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://derivatives.work/docs/neighborhood-spam/" /><meta property="article:section" content="docs" />



<title>Neighborhoods and bands: an analysis of the origins of spam | Derivatives</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.1a6fac2df464e68d664cb846d822c678cd622692d6fae24ee18901a08bfc8eb6.css" integrity="sha256-Gm&#43;sLfRk5o1mTLhG2CLGeM1iJpLW&#43;uJO4YkBoIv8jrY=" crossorigin="anonymous">
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.f917ae946da4bc41346f98b02d766afcf31424232c536549a2474379df48f116.js" integrity="sha256-&#43;ReulG2kvEE0b5iwLXZq/PMUJCMsU2VJokdDed9I8RY=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Derivatives</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  



  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/readme/" class="">README</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/architecture-human-orc/" class="">Architecture of the Human Origin Recognition Complex*</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/amyloid-%CE%B2/" class="">Origins of amyloid-β</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/arsenic/" class="">Effects of arsenic and heavy metals on metabolic pathways in cells of human origin: Similarities and differences</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/back-to-future/" class="">Back to the future: origins and directions of the “Agile Manifesto” – views of the originators</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/biopolymers/" class="">Folding, Assembly, and Persistence: The Essential Nature and Origins of Biopolymers</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-4e626a39f813bdfb0b0f11621a8d97e6" class="toggle"  />
    <label for="section-4e626a39f813bdfb0b0f11621a8d97e6" class="flex justify-between">
      <a href="https://derivatives.work/docs/cc-by/" class="">CC-BY</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/cc-by/cc-by-2-summary/" class="">Creative Commons License Deed Attribution 2.0 Generic (CC BY 2.0)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/cc-by/cc-by-2/" class="">Creative Commons Legal Code Attribution 2.0</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/cc-by/cc-by-3-summary/" class="">Creative Commons License Deed Attribution 3.0 Unported (CC BY 3.0)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/cc-by/cc-by-3/" class="">Creative Commons Attribution 3.0 Unported</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/cc-by/cc-by-4-summary/" class="">Creative Commons License Deed Attribution 4.0 International (CC BY 4.0)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/cc-by/cc-by-4-de/" class="">Creative Commons Konzessionsurkunde Namensnennung 4.0 International (CC BY 4.0)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/cc-by/cc-by-4/" class="">Creative Commons Legal Code Attribution 4.0 International</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/charon-smooth-plains/" class="">The nature and origin of Charon&#39;s smooth plains</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/chinese-word-cell/" class="">Origin of the Chinese word for “cell”: an unusual but wonderful idea of a mathematician</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/city-origins/" class="">City origins</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/counterfeit-versus-original/" class="">Counterfeit versus original patronage: Do emotional brand attachment, brand involvement, and past experience matter?</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/creatine/" class="">ON THE ORIGIN OF CREATINE</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/detecting-moisture/" class="">Detecting the origins of moisture over Southeast China: Seasonal variation and heavy Rainfall</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/differentiation-spirits/" class="">Differentiation Between Spirits According to Their Botanical Origin</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/food-taboos/" class="">Food taboos: their origins and purposes</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/ganges/" class="">Ganges: special at its origin</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/given-that-detailed/" class="">Given that the detailed original criteria for deliberate practice have not changed, could the understanding of this complex concept have improved over time? A response to Macnamara and Hambrick (2020)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/hanwoo-cattle/" class="">Hanwoo cattle: origin, domestication, breeding strategies and genomic selection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/hoarding/" class="">The developmental origins of hoarding disorder in adolescence: a longitudinal clinical interview study following an epidemiological survey</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/how-to-write/" class="">How to write an original article for the *Journal of Orthopaedics and Traumatology*</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/in-out-qinghai-tibet-plateau/" class="">“Into and Out of” the Qinghai-Tibet Plateau and the Himalayas: Centers of origin and diversification across five clades of Eurasian montane and alpine passerine birds</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/interview-patrick-o-brown/" class="">An interview with Patrick O Brown on the origins and future of open access</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/manipulated-photos/" class="">Can people identify original and manipulated photos of real-world scenes?</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/neighborhood-spam/" class=" active">Neighborhoods and bands: an analysis of the origins of spam</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-18bd70f4fad61eb2742d114842aa84cf" class="toggle"  />
    <label for="section-18bd70f4fad61eb2742d114842aa84cf" class="flex justify-between">
      <a href="https://derivatives.work/docs/letters/" class="">Letters</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/letters/non-neanderthal/" class="">Non-Neanderthal Origin of the HLA-DPB1*0401</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/letters/reply-to-ding/" class="">Reply to Ding et al.: Non-Neanderthal Origin of the HLA-DPB1*0401</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/origin-of-the-ectopic-beat/" class="">What is the origin of the ectopic beat?</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/origins/" class="">Origins</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/patient-safety/" class="">The 5th anniversary of “Patient Safety in Surgery” – from the Journal’s origin to its future vision</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/rendang/" class="">Tracing the origins of rendang and its development</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/soft-robot/" class="">Assessing the Impact of an Original Soft Communicative Robot in a Nursing Home in Japan: Will Softness or Conversations Bring more Smiles to Older People?</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/softwaretest-originaldaten/" class="">Softwaretest mit Originaldaten Eine Analyse aus Sicht des Datenschutzes</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/spectacular-submarine/" class="">Origin of spectacular fields of submarine sediment waves around volcanic islands</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/urban-conservation/" class="">Urban Conservation Through Chinese Local Original Architecture: The Preservation and Renovation of Zhongshan Road in Hangzhou</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/vertebrate-gills/" class="">The Origin of Vertebrate Gills</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/volcanic-origin-1741/" class="">Volcanic origin of the 1741 Oshima-Oshima tsunami in the Japan Sea</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/what-is-morita-therapy/" class="">What is Morita Therapy? The Nature, Origins, and Cross-Cultural Application of a Unique Japanese Psychotherapy</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://derivatives.work/docs/wildcat-reappearance/" class="">Revealing the origin of wildcat reappearance after presumed long-term absence</a>
  

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Neighborhoods and bands: an analysis of the origins of spam</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#abstract">Abstract</a></li>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#related-work">Related work</a></li>
    <li><a href="#methodology">Methodology</a>
      <ul>
        <li><a href="#collection-infrastructure">Collection infrastructure</a></li>
        <li><a href="#spam-campaigns-and-spam-bands">Spam campaigns and spam bands</a></li>
      </ul>
    </li>
    <li><a href="#collected-data">Collected data</a></li>
    <li><a href="#neighborhood-analysis">Neighborhood analysis</a>
      <ul>
        <li><a href="#distribution-of-ip-addresses-in-autonomous-systems">Distribution of IP addresses in autonomous systems</a></li>
        <li><a href="#analysis-of-neighborhoods-with-higher-transmission-power">Analysis of neighborhoods with higher transmission power</a></li>
        <li><a href="#grouping-of-autonomous-systems">Grouping of autonomous systems</a></li>
      </ul>
    </li>
    <li><a href="#spambands-analysis"><em>SpamBands</em> analysis</a>
      <ul>
        <li><a href="#relationship-between-spambands-and-ases">Relationship between SpamBands and ASes</a></li>
      </ul>
    </li>
    <li><a href="#conclusions">Conclusions</a></li>
    <li><a href="#references">References</a>
      <ul>
        <li><a href="#download-references">Download references</a></li>
      </ul>
    </li>
    <li><a href="#acknowledgments">Acknowledgments</a></li>
    <li><a href="#author-information">Author information</a>
      <ul>
        <li><a href="#affiliations">Affiliations</a></li>
        <li><a href="#corresponding-author">Corresponding author</a></li>
      </ul>
    </li>
    <li><a href="#additional-information">Additional information</a>
      <ul>
        <li><a href="#competing-interests">Competing interests</a></li>
        <li><a href="#authors-contributions">Authors’ contributions</a></li>
      </ul>
    </li>
    <li><a href="#rights-and-permissions">Rights and permissions</a></li>
    <li><a href="#reprints-and-permissions">Reprints and Permissions</a>
      <ul>
        <li><a href="#about-this-article">About this article</a></li>
        <li><a href="#cite-this-article">Cite this article</a></li>
        <li><a href="#share-this-article">Share this article</a></li>
        <li><a href="#get-shareable-link">Get shareable link</a></li>
      </ul>
    </li>
    <li><a href="#keywords">Keywords</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
<article class="markdown">
  <h1>
    <a href="/docs/neighborhood-spam/">Neighborhoods and bands: an analysis of the origins of spam</a>
  </h1>

  <h2>Osvaldo Fonseca, Elverton Fazzion, Pedro Henrique B Las-Casas, Dorgival Guedes, Wagner Meira Jr, Cristine Hoepers, Klaus Steding-Jessen &amp; Marcelo HP Chaves</h2>

  


  

  



 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal"> 
Skip to main content</br>
Advertisement</br>
 SpringerOpen

<p>
Search</br>
Get published</br>
Explore Journals</br>
Books</br>
About</br>
Login</p></div>


<p>Journal of Internet Services and Applications
a Springer  




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Open Journal
<p>
About</br>
Articles</br>
Submission Guidelines</br>
Research</br>
Open Access</p></div>


Published: 11 May 2015
Neighborhoods and bands: an analysis of the origins of spam</p>
<p>Osvaldo Fonseca<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>*, Elverton Fazzion<sup id="fnref1:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>, Pedro Henrique B Las-Casas<sup id="fnref2:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>, Dorgival Guedes<sup id="fnref3:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>, Wagner Meira Jr<sup id="fnref4:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>, Cristine Hoepers<sup id="fnref5:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>, Klaus Steding-Jessen<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> &amp; Marcelo HP Chaves<sup id="fnref1:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>
Journal of Internet Services and Applications volume 6, Article number: 9 (2015) Cite this article</p>
<p>* Correspondence: <a href="mailto:osvaldo.morais@dcc.ufmg.br">osvaldo.morais@dcc.ufmg.br</a></p>
<p>1 Department of Computer Science, Universidade Federal de Minas Gerais, Belo Horizonte, Brazil
Full list of author information is available at the end of the article</p>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">
1840 Accesses
2 Citations
2 Altmetric
Metrics details</div>


<p>© 2015 Fonseca et al.; licensee Springer. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<a href="http://creativecommons.org/licenses/by/4.0%29">http://creativecommons.org/licenses/by/4.0)</a>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited.</p>
<h2 id="abstract">
  Abstract
  <a class="anchor" href="#abstract">#</a>
</h2>
<p>Despite the continuous efforts to mitigate spam, the volume of such messages continues to grow and identifying spammers is still a challenge. Spam traffic analysis is an important tool in this context, allowing network administrators to understand the behavior of spammers, both as they obfuscate messages and try to hide inside the network. This work adds to that body of information by analyzing the sources of spam to understand to what extent they explain the traffic observed. Our results show that, in many cases, an Autonomous System (AS) represents an interesting neighborhood to observe, with most ASes falling into four basic types: heavy and light senders, which tend to have many or very few spammer machines respectively, frequent small offenders, where spammer machines appear every now and then but disappear in a short time, and conniving ASes, where most machines do not send spam, but a few are heavy, continuous senders. Not only that, but also by grouping machines based on the campaigns that they send together, we define the notion of <em>SpamBands</em>. Those bands identify groups of machines that are probably controlled by the same spammer, and our findings show that they often span multiple ASes. The identification of AS neighborhood types and SpamBands may simplify the combat against spam, focusing efforts at the sources as a whole, possibly improving blacklists by grouping machines found in a same AS or SpamBands.</p>
<p><strong>Keywords:</strong> Spam traffic; Autonomous system; Network bad neighborhoods</p>
<h2 id="introduction">
  Introduction
  <a class="anchor" href="#introduction">#</a>
</h2>
<p>In the last two decades, there has been a steady increase in the use of Internet, which led to an increase of the problems related to the sending of spam messages. In addition to the large volume of data generated, since the email service providers estimate that between 40% and 80% of electronic messages are spam, many times they are related to the propagation of phishing [1] and malware [2]. Because of those factors, the losses caused by spam traffic are estimated in billions of dollars [3].</p>
<p>To try to counter those effects, the battle against spammers takes place on several fronts. For example, much has been done to develop filters based on message content, defining rules to identify patterns of obfuscation observed in spam messages [4]. Besides that, in recent years, multiple efforts have focused on understanding spam traffic within the network. The goal in that case is to find elements that can be used to identify the machines that send the messages before they traverse the network and consume resources of mail servers at the destination. This work fits in this line, analyzing where are the machines used by spammers.</p>
<p>Recently, the term Internet Bad Neighborhoods was created to identify contiguous ranges of IP address space that contain a significant number of machines with unwanted behavior [5]. The principle behind the original concept was that machines with similar (bad) behavior that shared an IP prefix would suggest they belong to a same network with problems. Later, the concept was extended to refer to network segments propagating unwanted traffic, regardless of the number of machines involved [6]. The granularity chosen for those analysis was that of /24 address ranges.</p>
<p>Our analysis is based on similar principles, but we chose the level of Autonomous Systems (AS) to identify possible bad neighborhoods. Autonomous Systems, by nature, identify an IP address range under the control of a single entity responsible for defining usage policies, routing, and administrative procedures to be applied to all machines installed in that range. In this sense, two IP addresses belonging to the same AS would have a much greater chance of exhibiting similar behavior than two IP addresses on subnets with adjacent addresses (the IP space), but belonging to different ASes. After all, an AS with security flaws in its policies is at risk of becoming a potential Bad Neighborhood, since the probability of machines belonging to that AS being infected and starting to send spam is high. It should be pointed, though, that some ASes may be under split management; that could be better treated by considering BGP announced prefixes, but that information was not available in the collected data.</p>
<p>Our data contain spam traffic collected at various points around the globe, which gives us multiple vantage points over the network. By grouping the machines that generate the traffic based on their origin AS, we created a profile of the behavior of each Autonomous System observed during the experiment. Our results show that the majority of machines sending spam are concentrated in a few ASes and that only 15 of them are responsible for over 80% of the observed traffic. By using data mining techniques, we observed that there are similarities between some of them, and that it is possible to group them in four categories representing the AS from the point of view of their role in the distribution of spam. This finding is one of the main contributions of this work, since, until then, it was common to assume that there would be only two types of generators of spam: “light” and “heavy” transmitters. Our characterization indicates that in addition to spam-free and bad neighborhoods (where bad behavior — spamming — is quite common), there are also good neighborhoods, where such behavior is not the norm, but appears from time to time, usually rapidly disappearing shortly after its appearance in one or another machine, and conniving neighborhoods, where misbehaving machines were not widespread, but limited to only a few hosts, which tend, however, to be heavy senders.</p>
<h2 id="related-work">
  Related work
  <a class="anchor" href="#related-work">#</a>
</h2>
<p>This work analyzes spam based on its behavior as seen “inside the network”, not based on data from destination mail servers. In that sense, it relates to the works of Ramachandran and Feamster [7], one of the first to study spam from network-level features. Although we consider such features, since we have access to the spam content, we combine different views. Duan, Gopalan and Yuan [8] have recently provided a similar analysis, although based on a single point of observation (a large university campus).</p>
<p>The definition of Bad Neighborhoods, mentioned in the introduction, is due to van Wanrooij and Pras, who proposed the concept as an extension of the use of blacklists in the spam detection [5]. In their study, each 24-bit IP prefix (/24) would be a neighborhood and bad neighborhoods would be those with a large number of machines sending spam. Moreira Moura <em>et al</em>. [6] focused on the analysis of these neighborhoods and extended the definition to include IP networks with few transmitters, but with a high volume of traffic, following the classification of “heavy” and “light” transmitters previously proposed by Pathak, Hu and Mao [9]. In our work, we observe that each AS can be seen as a neighborhood, because an autonomous system naturally defines an area with similar machines, since there is a unique management for the whole AS and a common routing policy for all machines.</p>
<p>Many studies analyze spam traffic using messages collected at the destination mail servers. Gomes <em>et al</em>. [10] showed features that can be used to separate legitimate messages from spam messages, using data collected from only one specific point of the network. In this work, spam messages were collected by low-interaction honeypots installed in 10 different countries and located in transit networks. This provided a more global view of spam traffic, offering a different perspective.</p>
<p>Kokkodis and Faloutsos [11] showed results that indicate that the activities of botnets are scattered in the IP address space, reducing the effectiveness of anti-spam filters based on addresses and hindering the work of network administrators. Our work, despite confirming the existence of spammers in a very large number of networks, shows that most of the spam messages come from a small number of ASes, a result that can be used in the development of new techniques for spam detection, as in the design of initiatives to act against such sources.</p>
<p>Some of our analysis is based on the concept of spam campaigns. Our definition is based on the identification of frequent patterns in the content, using data mining techniques [12]. Other approaches have been proposed, like the use of regular expressions [13]. Our approach fits better with our processing pipeline, where multiple data mining algorithms are applied to derive different views, such as those in this paper.</p>
<p>This paper is based on previous work, so far available only in Portuguese. In a first paper [14], we performed a detailed analysis of spam messages collected over three months around the world to observe Bad Neighborhoods. With the same dataset, we developed the concept of SpamBands [15], another way to analyze the origin of spammers. (All the major concepts from those papers are included here, to provide a complete source in English). In the current work we extend our analysis of both concepts to cover data from approximately one year, and for the first time we use both concepts, Neighborhoods and SpamBands, to study the relationship between them. That allowed us to identify new patterns, such as the strong correlation between IP addresses in SpamBands and bad neighborhoods, and a topological relationship among spammers, since the IP addresses from a SpamBand usually come from just a few ASes. We hope that our findings can help drive the spam community’s efforts to combat spammers closer to their origin.</p>
<h2 id="methodology">
  Methodology
  <a class="anchor" href="#methodology">#</a>
</h2>
<p>Three aspects of our methodology deserve attention: the collection architecture, and our techniques to identify spam campaigns, and to define <em>SpamBands</em>. They are presented next.</p>
<h3 id="collection-infrastructure">
  Collection infrastructure
  <a class="anchor" href="#collection-infrastructure">#</a>
</h3>
<p>The dataset used in this work was collected using twelve low-interaction honeypots [16] installed in ten different country codes: two in Brazil, two in the United States and one in each of Argentina, Australia, Austria, Ecuador, Netherlands, Norway, Taiwan and Uruguay. That means we had collectors present in four different continents, allowing the study to have a global view of spam traffic. By doing that, we avoided the problem of location bias, which may be present in several studies in the literature, whose data often come from a single collection point. Furthermore, none of the honeypots used in the analysis showed any signs of having been subjected to any form of attack.</p>
<p>The honeypots used in this paper are machines that simulate machines of interest to spammers, such as open SMTP mail relays and HTTP and SOCKS open proxies. Their goal is to lure spammers to identify them as vulnerable machines and use them to try to deliver spam messages. In practice, the honeypots do not deliver spam messages to the intended recipients; instead, they are stored locally and periodically collected to a central storage. The behavior of honeypots, however, is such that it makes the spammer believe that the delivery was successful. That is corroborated by the fact that each most machines continues to abuse the honeypots for all the collection period.</p>
<p>It should be noted that our analysis is guided by the traffic that was directed to our honeypots. There may be spammers that do not make use of proxies/relays to deliver their messages, and those are not considered in this analysis. However, is highly unlikely that a heavy spammer, using a dedicated server farm, would remain in activity without such a technique: it would be easily identified by black lists and blocked, since it uses few origin IP addresses. On the other hand, if a botnet delivers spam directly to the target mail servers all the time, we would not see it in our data.</p>
<p>Along with each message received, additional information is collected and stored by the system. This information includes the protocol used by the spammer to connect to the honeypot, (SMTP, HTTP or SOCKS), the network prefix and AS of origin, the status of the source IP in blacklists like Spamhaus XBL and PBL at the moment each message was delivered, among others. All that is obtained at the time the message is received, so that we have a snapshot of things as they were at the moment the spammer tried to send each message. Thus, our analysis considers the information available at the time of the transmission and not during a later query, which could cause error. That is essential, for example, for the analysis of black list contents, which might change between the time of collection and analysis.</p>
<p>Later, during the analysis, some ASes deserved further study. In those cases, based on their AS numbers, we gathered data available on the Internet to get more details about their activities. Based on the activities that were identified during that search, we classified the ASes as providers (general, DSL, corporative), hosting/co-location services, etc.</p>
<h3 id="spam-campaigns-and-spam-bands">
  Spam campaigns and spam bands
  <a class="anchor" href="#spam-campaigns-and-spam-bands">#</a>
</h3>
<p>To better understand the behavior of spammers, we used the concept of spam campaigns. A campaign is a set of messages that share a common goal (similar content) and a common dissemination strategy [12]. We used the FPCluster algorithm to group messages based on their various attributes and to identify the obfuscation strategies used. That algorithm builds a frequent pattern tree, which is then used to extract the message clustering patterns, which in turn identify the campaigns [12,17].</p>
<p>Through the identification of campaigns, we detect the influence of each orchestrated campaign on the spam traffic collected, as well as the emergence of new IP addresses that join a given campaign. Based on those observations, Fazzion <em>et al</em>. [15] developed a method that can identify groups of transmitters that are correlated, called <em>SpamBands</em>. Since that work was published in Portuguese, the method is described here for completeness.</p>
<p>The premise of <em>SpamBands</em> was that machines which generate the same campaigns are controlled by the same orchestrator, being related in terms of dissemination strategy used. Thus, a <em>SpamBand</em> is a group of machines that works together on the same set of campaigns. The relationship between machines and campaigns can be modeled as a graph G, where the machines are vertices and there is an edge between two machines if they sent messages associated with the same campaign. Figure 1 illustrates the construction of this graph.</p>
<p>
  <img src="/img/neighborhood-spam_fig1.png" alt="SpamBand graph construction">
</p>
<figcaption>
<p><strong>Figure 1</strong>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">figure1</div>


SpamBand graph construction. The graph represents IP addresses that sent spam as vertices. There is an edge between two vertices if they took part in the same spam campaign.</p>
</figcaption>
<p> 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size image</div>


From G, we can define a <em>SpamBand</em> as a dense sub-graph that can be obtained by several clustering algorithms in graphs in the literature which can be quite complex and hard to calibrate [18]. Our strategy is more simple and interactive. Initially, each <em>SpamBand</em> is a connected component.</p>
<p>In some cases, however, one IP address may be found connected to more than one such sub-graph. That may be due to IP address reassignment, or use of NAT. To handle that, in a second moment, we evaluate those cases, which can require the split of certain connected components in order to isolate subgraphs with higher density.</p>
<p>The process to identify <em>SpamBands</em> is presented in Algorithm 1. The algorithm receives three parameters: the graph (G), the minimum threshold betweenness to be considered (<strong>threshold_bt</strong>) and the maximum number of IP addresses that can be removed in order to split a connected component (<strong>threshold_ips</strong>).</p>
<p><strong>Algorithm 1</strong>: <em>SpamBand</em> (Graph G, Float threshold_bt, Float threshold_ips)</p>
<pre tabindex="0"><code>S = ∅; 
C=G.ConnectedComponents(); ; 
for comp in C do
    ips_to_remove = ∅ ; 
    for ip in comp do
        if ip.Betweenness() &gt; threshold_bt*comp.BiggestBetweenness() then
            ips_to_remove.Add(ip);
        end 
    end
    if ips_to_remove.size() &gt; threshold_ips*comp.NodesNumber() then
        S += comp;
    end 
    else
        S += comp.RemoveNodes(ips_to_remove);
    end 
end
return S;
</code></pre><p>The first step is to determine the connected components in G which constitute the initial approximation of the <em>SpamBands</em>. Next, we identify dense sub-graphs in each connected component exploring the betweenness concept, which measures the centrality degree of a node in the graph. This metric indicates the number of shortest paths among all pair of nodes in the graph that pass through a given node. Our premise is that when some nodes have a high value of <em>betweenness</em>, beyond what would be expected for a strongly connected graph, chances are that those nodes are connecting two (or more) sub-graphs which are, themselves, internally dense. Thus, by removing those nodes, we are emphasizing the separation of those internally dense sub-graphs. This removal is based on the parameters <strong>threshold_bt</strong>, which is the lower bound of <em>betweenness</em> that a node may have in order to be removed, and <strong>threshold_ips</strong>, which defines a maximum threshold of the number of nodes that can be removed in order to split a component. Algorithm 1 initially verifies which nodes satisfy the <em>betweenness</em> threshold in each connected component and next verifies if their removal does not lead very small graphs. If it is possible to remove the nodes, each resultant component is inserted in S. If not, the current component is inserted in S. The algorithm returns the set S which holds all <em>SpamBands</em>.</p>
<h2 id="collected-data">
  Collected data
  <a class="anchor" href="#collected-data">#</a>
</h2>
<p>Our analysis considers approximately one year of collection, from May 9, 2012, until March 31, 2013, resulting in nearly four billion messages (14 TB). By analyzing a large period, we avoid any impact due to an atypical behavior, which could occur in a short period of time.</p>
<p>Table 1 shows an overview of the data collected by the twelve honeypots and used in the study, broken down by the protocol used by the spammers. During the period of almost a year, 3.97 billion messages were collected, which correspond to 14 TB of data. The addresses of the machines that sent spam were associated with 149 different country codes, which corresponded to about 60% of all country codes. We can also notice a large number of autonomous systems, 3,226, showing that the collection included many subnets of origin.</p>
<p><strong>Table 1 Global vision of the data</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>SMTP</th>
<th>SOCKS</th>
<th>HTTP</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr>
<td>Messages (x106)</td>
<td>690 (17.4%)</td>
<td>2,486 (62.5%)</td>
<td>799 (20.1%)</td>
<td>3,976</td>
</tr>
<tr>
<td>IP addresses</td>
<td>294,072</td>
<td>34,397</td>
<td>11,449</td>
<td>328,050</td>
</tr>
<tr>
<td>Autonomous systems</td>
<td>3,096</td>
<td>443</td>
<td>55</td>
<td>3,226</td>
</tr>
<tr>
<td>Country codes</td>
<td>146</td>
<td>66</td>
<td>14</td>
<td>149</td>
</tr>
<tr>
<td>Volume (GB)</td>
<td>2,564</td>
<td>8,522</td>
<td>3,378</td>
<td>14,464</td>
</tr>
</tbody>
</table>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">
Full size table</div>


<p>The number of IP addresses using SOCKS and HTTP protocol is much smaller when compared to the number of IP addresses that used the SMTP protocol. Nevertheless, the number of messages sent using HTTP and SOCKS is larger. This shows that there is not a direct relationship between the number of machines and the number of messages sent. This division is a sign of the differentiation between spammers: some adopt strategies based on high volume over a certain protocol, while others may send lower volumes, using more machines, over another protocol. In fact, during our analysis we will see that there are more factors to be considered.</p>
<h2 id="neighborhood-analysis">
  Neighborhood analysis
  <a class="anchor" href="#neighborhood-analysis">#</a>
</h2>
<p>In this work, we advocate that ASes can be used for the identification of the limits of the neighborhoods, instead of /24 prefixes, as used in the original definition [5]. That provides a more natural aggregation of addresses, given that fixed-length prefixes are not adequate for all cases.</p>
<p>To show that, in Table 1 we observe that spam messages come from many different networks, since 3,226 distinct autonomous systems appeared in the collected data. It is interesting to notice that most of those spam messages were sent by a very small number of autonomous systems, being fifty of them responsible for over 85% of all traffic. Thus, analyzing the behavior of spam at the source can direct the efforts to fight spam as it can identify which are the neighborhoods that have worst behavior, and, consequently, that are more likely to send spam messages.</p>
<h3 id="distribution-of-ip-addresses-in-autonomous-systems">
  Distribution of IP addresses in autonomous systems
  <a class="anchor" href="#distribution-of-ip-addresses-in-autonomous-systems">#</a>
</h3>
<p>Figure 2(a) shows that for the majority of Autonomous Systems, only a few devices were seen contacting the honeypots. In almost 90% of the ASes, the number of machines observed was smaller than 20. In Table 2, we can clearly see the existence of a large group of AS with a small number of IP addresses sending spam messages and another group, smaller, which contains most of those addresses. This shows that the machines that send spam messages are not evenly distributed across the Autonomous Systems.</p>
<p>
  <img src="/img/neighborhood-spam_fig2.png" alt="Distribution of active IP numbers per AS, as well as the distribution of the number of IPs from an AS present in the XBL, PBL black lists (or not present in any BL).">
</p>
<figcaption>
<p><strong>Figure 2</strong>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">figure2</div>


Distribution of active IP numbers per AS, as well as the distribution of the number of IPs from an AS present in the XBL, PBL black lists (or not present in any BL).<strong>(a)</strong> CDF of the number of IP addresses per AS. <strong>(b)</strong> CDF of the percentage of IP addresses in XBL per AS. <strong>(c)</strong> CDF of the percentage of IP addresses in PBL per AS. <strong>(d)</strong> CDF of the percentage of IP addresses that are not in any blacklist per AS.</p>
</figcaption>
<p> 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size image</div>


<strong>Table 2 Number of IP addresses observed per AS</strong></p>
<table>
<thead>
<tr>
<th>IP addr. per AS (x)</th>
<th>#AS</th>
<th>#Msgs (x106)</th>
<th>#IP addr.</th>
</tr>
</thead>
<tbody>
<tr>
<td>x = 1</td>
<td>1,581 (49.0%)</td>
<td>108 (2.7%)</td>
<td>1,581 (0.5%)</td>
</tr>
<tr>
<td>x &lt;10</td>
<td>2,705 (83.9%)</td>
<td>305 (7.7%)</td>
<td>5,635 (1.7%)</td>
</tr>
<tr>
<td>x &lt;50</td>
<td>3,061 (94.9%)</td>
<td>797 (20.0%)</td>
<td>13,309 (4.6%)</td>
</tr>
<tr>
<td>x &lt;100</td>
<td>3,131 (97.1%)</td>
<td>1,150 (28.9%)</td>
<td>18,159 (5.5%)</td>
</tr>
<tr>
<td>x ≥ 100</td>
<td>95 (2.9%)</td>
<td>2,825 (71.1%)</td>
<td>319,554 (97.4%)</td>
</tr>
</tbody>
</table>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size table</div>


<p>Those ASes that have fewer than 10 machines that send spam, account for over 83% of the total. Nevertheless, they send only 7.66% of the messages and correspond in number of machines to 1.7% of the total. Thus, we believe that in terms of neighborhoods, these AS are not characterized as bad neighborhoods, but that their security policies are being implemented correctly, because of the small number of spamming IP addresses and the low volume of traffic generated by them. On the other hand, 95 autonomous systems (2.94%) have more than 319,000 IP addresses in the dataset (97.41%) and are responsible for 71% of traffic from spam, which corresponds to almost 3 billion messages. Those neighborhoods show bad behavior, possibly due to weak security policies. Thus, direct efforts to understand and improve the behavior of those networks might have impact on the overall traffic.</p>
<p>Figure 2 also shows the distribution of IP addresses present in each blacklist. The two black lists considered here are XBL, which lists IP addresses detected as infected, and PBL, which lists IP ranges declared by ISPs as being used for dynamic hosts — which should not send mail directly. Finally, we consider IPs that were not found in any of the blacklists considered (No BL). There is a very small number of Autonomous Systems that do not have IP addresses in XBL, about 15%, as we can see in Figure 2(b). In addition, approximately 60% of the ASes have all their IP addresses in XBL. This result makes us believe that most IP addresses are detected by the XBL, but what happens is that a good portion of the ASes listed there (49%) have only one spamming IP address (therefore, 100% of their addresses are in the XBL).</p>
<p>Considering that, the information about the IP addresses that are in the PBL and those who do not participate in any blacklist (nobl) end up getting distorted, as shown in Figures 2 (c) and 2 (d). In the graph of Figure 2 (c), for example, more than 70% of autonomous systems have no IP address present in the PBL, but more than 85% of IP addresses found in the period of analysis are in PBL as shown in Table 3. The IP addresses that are not in any blacklist, belong mostly to a few ASes, and represent a very small portion of the IP addresses, less than 12%. However, this small number of machines is responsible for over 68% of all spam traffic, as shown in Table 3.</p>
<p><strong>Table 3 Overview of blacklists</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>#IP addresses</th>
<th>#Messages (106)</th>
</tr>
</thead>
<tbody>
<tr>
<td>XBL</td>
<td>66,388 (20.2%)</td>
<td>594 (14.9%)</td>
</tr>
<tr>
<td>PBL</td>
<td>282,599 (86.2%)</td>
<td>789 (19.8%)</td>
</tr>
<tr>
<td>No BL</td>
<td>41,005 (12.5%)</td>
<td>2,714 (68.3%)</td>
</tr>
</tbody>
</table>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size table</div>


<h3 id="analysis-of-neighborhoods-with-higher-transmission-power">
  Analysis of neighborhoods with higher transmission power
  <a class="anchor" href="#analysis-of-neighborhoods-with-higher-transmission-power">#</a>
</h3>
<p>Table 4 shows the 15 ASes that sent the most spam messages in the period analyzed, being, by themselves, responsible for more than 80% of all spam traffic. This information can be incorporated into spam filters and used by network administrators to reduce the volume of spam, since messages sent by those AS tend to be spam. By analyzing them, in spite of the fact that all send a large volume of spam, we see that there are some neighborhoods that have very different characteristics from each other. On the other hand, it is possible to notice that some of them are very similar, although they have no direct relationship.</p>
<p><strong>Table 4 15 most important autonomous systems</strong></p>
<table>
<thead>
<tr>
<th>AS</th>
<th>Msgs (106)</th>
<th>IP addr.</th>
<th>IP SMTP</th>
<th>IP SOCKS</th>
<th>IP HTTP</th>
<th>IP XBL</th>
<th>IP PBL</th>
<th>IPNoBL</th>
<th>vol. (GB)</th>
<th>Classification</th>
</tr>
</thead>
<tbody>
<tr>
<td>10297</td>
<td>1.857</td>
<td>182</td>
<td>22.5%</td>
<td>77.5%</td>
<td>77.5%</td>
<td>17.0%</td>
<td>0.0%</td>
<td>83.0%</td>
<td>5,475</td>
<td>hosting/co-location</td>
</tr>
<tr>
<td>3462</td>
<td>359</td>
<td>100,395</td>
<td>78.7%</td>
<td>22.1%</td>
<td>6.8%</td>
<td>7.7%</td>
<td>99.8%</td>
<td>0.1%</td>
<td>1,320</td>
<td>DSL/ISP</td>
</tr>
<tr>
<td>29802</td>
<td>298</td>
<td>25</td>
<td>16.0%</td>
<td>84.0%</td>
<td>84.0%</td>
<td>12.0%</td>
<td>0.0%</td>
<td>88.0%</td>
<td>781</td>
<td>hosting</td>
</tr>
<tr>
<td>9299</td>
<td>148</td>
<td>82</td>
<td>39.0%</td>
<td>61.0%</td>
<td>26.8%</td>
<td>34.2%</td>
<td>1.2%</td>
<td>65.9%</td>
<td>342</td>
<td>DSL/business</td>
</tr>
<tr>
<td>2497</td>
<td>141</td>
<td>1,185</td>
<td>0.2%</td>
<td>99.6%</td>
<td>99.0%</td>
<td>0.2%</td>
<td>19.4%</td>
<td>80.4%</td>
<td>559</td>
<td>hosting/clouding</td>
</tr>
<tr>
<td>4134</td>
<td>126</td>
<td>110,123</td>
<td>99.7%</td>
<td>0.3%</td>
<td>0.2%</td>
<td>15.8%</td>
<td>81.8%</td>
<td>17.1%</td>
<td>2,446</td>
<td>DSL</td>
</tr>
<tr>
<td>6648</td>
<td>124</td>
<td>54</td>
<td>9.3%</td>
<td>90.7%</td>
<td>40.7%</td>
<td>9.3%</td>
<td>90.7%</td>
<td>1.9%</td>
<td>279</td>
<td>DSL/business</td>
</tr>
<tr>
<td>4725</td>
<td>31</td>
<td>215</td>
<td>0.9%</td>
<td>99.1%</td>
<td>98.6%</td>
<td>0.9%</td>
<td>95.8%</td>
<td>3.3%</td>
<td>120</td>
<td>clouding/business</td>
</tr>
<tr>
<td>27699</td>
<td>31</td>
<td>1,382</td>
<td>7.7%</td>
<td>92.3%</td>
<td>0.0%</td>
<td>9.2%</td>
<td>95.2%</td>
<td>2.7%</td>
<td>114</td>
<td>DSL/business</td>
</tr>
<tr>
<td>18881</td>
<td>28</td>
<td>3,091</td>
<td>10.7%</td>
<td>89.3%</td>
<td>0.0%</td>
<td>8.6%</td>
<td>96.1%</td>
<td>2.0%</td>
<td>97</td>
<td>co-location/ISP</td>
</tr>
<tr>
<td>8167</td>
<td>25</td>
<td>198</td>
<td>38.9%</td>
<td>61.1%</td>
<td>0.0%</td>
<td>37.4%</td>
<td>34.8%</td>
<td>41.4%</td>
<td>95</td>
<td>clouding/ISP</td>
</tr>
<tr>
<td>4837</td>
<td>23</td>
<td>20,551</td>
<td>99.9%</td>
<td>0.1%</td>
<td>0.0%</td>
<td>26.5%</td>
<td>78.4%</td>
<td>18.5%</td>
<td>97</td>
<td>-</td>
</tr>
<tr>
<td>9924</td>
<td>22</td>
<td>1,959</td>
<td>1.3%</td>
<td>82.1%</td>
<td>98.6%</td>
<td>2.8%</td>
<td>99.6%</td>
<td>0.1%</td>
<td>77</td>
<td>-</td>
</tr>
<tr>
<td>28573</td>
<td>21</td>
<td>700</td>
<td>75.7%</td>
<td>24.3%</td>
<td>0.0%</td>
<td>46.9%</td>
<td>98.4%</td>
<td>0.9%</td>
<td>76</td>
<td>ISP</td>
</tr>
<tr>
<td>4230</td>
<td>20</td>
<td>429</td>
<td>21.7%</td>
<td>78.3%</td>
<td>78.3%</td>
<td>31.0%</td>
<td>67.6%</td>
<td>11.0%</td>
<td>67</td>
<td>hosting/ISP</td>
</tr>
</tbody>
</table>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size table</div>


<p>Some autonomous systems (10297 and 29802) have similar characteristics in virtually all aspects. They have a small number of IP addresses in our dataset, most of them using SOCKS and HTTP protocols to send spam, and do not belong to any blacklist. AS 2497 is also very similar, despite having a larger number of machines. AS 4725, in turn, differs only by having a large number of IP addresses in PBL blacklist. The machines of those neighborhoods behave like dedicated servers used to send spam: they use SOCKS and HTTP protocols, meaning they do not contact any mail host directly (only through proxies), each sends a large number of messages, and most of them are not in any blacklist.</p>
<p>In contrast, we find some neighborhoods with completely different characteristics, such as Autonomous Systems 3462 and 4134. Both have more than 100,000 IP addresses in our dataset, the vast majority of machines observed used the SMTP protocol to send spam and most of them were in some blacklist. In addition, AS 4134 has very striking features, with more than 99% of their IP addresses sending spam messages using the SMTP protocol and about 17,000 of them in XBL.</p>
<h3 id="grouping-of-autonomous-systems">
  Grouping of autonomous systems
  <a class="anchor" href="#grouping-of-autonomous-systems">#</a>
</h3>
<p>Because of the evidence mentioned in Section 5.2, we looked for a way to group the AS observed and classify them according to their characteristics. For this, we use the X-means clustering algorithm [19], considering the characteristics of each neighborhood as attributes. The algorithm has the quality of automatically setting the optimum number of clusters to use, unlike other clustering algorithms.</p>
<p>To perform the clustering, we used as features the characteristics that better represent the Autonomous Systems in our analysis. The attributes carry information such as number of IP addresses observed, number of messages per day, percentage of the IP addresses in blacklists, percentage of IP addresses using each protocol, and the average number of messages sent per IP address. Those attributes proved to be a good set to identify the neighborhoods, because they define the major elements of behavior that machines on those networks can present.</p>
<p>Table 5 exhibits the properties of each of the four groups generated. Group 1 contains 64% of the ASes, and most of them have a very small number of observed IP addresses. Most of the machines in that group use SMTP protocol and are in XBL. Group 2 also has a small number of IP addresses, but it is responsible for most of the spam sent (65%). In addition, more than 98% of the messages were sent using SOCKS and HTTP protocols, although most of the IP addresses (84%) use the SMTP protocol to send spam. The vast majority of messages (97%) was sent by machines that were not in any blacklist. Group 3 differs from the others because more than 99% of its IP addresses sent messages through the SMTP protocol and most of them are in PBL and XBL. Finally, the fourth group contains the ASes with a large number of machines observed in the dataset. The majority of their IP addresses are in PBL, and only a smaller number is in XBL. Although most of the machines used SMTP, the highest volume of spam was sent using the SOCKS protocol.</p>
<p><strong>Table 5 Features of each group</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>Group 1</th>
<th>Group 2</th>
<th>Group 3</th>
<th>Group 4</th>
</tr>
</thead>
<tbody>
<tr>
<td>ASes</td>
<td>2,064</td>
<td>449</td>
<td>359</td>
<td>354</td>
</tr>
<tr>
<td>Msgs (x106 )</td>
<td>379</td>
<td>2,602</td>
<td>88</td>
<td>907</td>
</tr>
<tr>
<td>No. IP Addresses</td>
<td>8,426</td>
<td>16,024</td>
<td>11,503</td>
<td>301,760</td>
</tr>
<tr>
<td>Msgs/IP (x103)</td>
<td>45.0</td>
<td>162.4</td>
<td>7.6</td>
<td>3.0</td>
</tr>
<tr>
<td>Activity1</td>
<td>48.8</td>
<td>63.4</td>
<td>67.1</td>
<td>85.3</td>
</tr>
<tr>
<td>Msgs-SMTP</td>
<td>85.3%</td>
<td>1.5%</td>
<td>71.4%</td>
<td>29.2%</td>
</tr>
<tr>
<td>Msgs-SOCKS</td>
<td>13.5%</td>
<td>75.3%</td>
<td>23.2%</td>
<td>50.3%</td>
</tr>
<tr>
<td>Msgs-HTTP</td>
<td>1.2%</td>
<td>23.2%</td>
<td>5.4%</td>
<td>20.5%</td>
</tr>
<tr>
<td>Msgs-Xbl</td>
<td>81.9%</td>
<td>1.7%</td>
<td>68.6%</td>
<td>20.0%</td>
</tr>
<tr>
<td>Msgs-Pbl</td>
<td>2.8%</td>
<td>1.4%</td>
<td>52.0%</td>
<td>76.8%</td>
</tr>
<tr>
<td>Msgs-No-Bl</td>
<td>17.2%</td>
<td>97.2%</td>
<td>15.0%</td>
<td>11.7%</td>
</tr>
<tr>
<td>IPs-Xbl</td>
<td>83.5%</td>
<td>13.2%</td>
<td>64.7%</td>
<td>16.5%</td>
</tr>
<tr>
<td>IPs-Pbl</td>
<td>5.2%</td>
<td>12.9%</td>
<td>86.6%</td>
<td>89.5%</td>
</tr>
<tr>
<td>IPs-No-Bl</td>
<td>15.2%</td>
<td>77.7%</td>
<td>7.1%</td>
<td>8.8%</td>
</tr>
<tr>
<td>Volume (TB)</td>
<td>1.2</td>
<td>7.55</td>
<td>0.36</td>
<td>4.98</td>
</tr>
<tr>
<td>IPs-SMTP</td>
<td>97.43%</td>
<td>84.62%</td>
<td>99.19%</td>
<td>89.01%</td>
</tr>
<tr>
<td>IPs-SOCKS</td>
<td>2.67%</td>
<td>15.27%</td>
<td>0.82%</td>
<td>11.12%</td>
</tr>
<tr>
<td>IPs-HTTP</td>
<td>0.33%</td>
<td>9.52%</td>
<td>0.02%</td>
<td>3.44%</td>
</tr>
</tbody>
</table>
<figcaption>
<p>1 Average of days, in the analyzed period, in which the machines of this group were active.</p>
</figcaption>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size table</div>


<p>If we consider the neighborhoods that sent more spam messages, studied in Section 5.2, we see that the clustering placed ASes with similar characteristics in the same group, and separated those with different behaviors. Autonomous Systems 10297, 29802, and 2497, whose machines behave like dedicated servers, ended up in group 2, responsible for most of the spam traffic, even though having fewer IP addresses. Moreover, that group has few machines in blacklists, which is a necessary feature for machines that send a large volume of messages — otherwise they would not be effective.</p>
<p>Most machines from Autonomous Systems 3462 and 4134 behave like bots and those two neighborhoods are part of the Group 4. That group includes ASes that have a large number of IP addresses with most of them in blacklists. It is also observed that most of the IP addresses in that group sent a small amount of messages.</p>
<p>By analyzing the 15 neighborhoods highlighted in Section 5.2, we found that none of them are in groups 1 or 3, as can be seen in Table 4. This result was already expected, since the ASes in group 1 have a very small number of IP addresses and those from group 3 have few machines that send spam and are responsible for few spam messages. Thus, the neighborhoods that send more spam were allocated to the other two groups: ASes that have a lot of IP addresses and those that send a large amount of spam messages.</p>
<p>We believe these results may be used in at least two important ways: to help guide policies used by different network managers in the way they treat data from ASes known to fall into a certain class, and to help the network community to identify organizations that may be in need of some orientation on how to handle their security (those with a large number of low volume spamming IPs), or those that may require some pressure to act against server-heady spammers that may be among their clients.</p>
<h4 id="531-group-1">
  5.3.1 Group 1
  <a class="anchor" href="#531-group-1">#</a>
</h4>
<p>The graph in Figure 3(a) shows that a very small percentage of the neighborhoods of this group use the SOCKS and HTTP protocols to send spam messages and that over 70% of the AS send less than 100 thousand of messages in the period. Although the number of messages is small, given that we collected for almost one year, we can see in Table 5 that this group had a very small number of IP addresses observed, resulting in a relatively high number of messages by IP address.</p>
<p>
  <img src="/img/neighborhood-spam_fig3.png" alt="Distribution of messages sent and active IP numbers for ASes in group 1.">
</p>
<figcaption>
<p><strong>Figure 3</strong>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">figure3</div>


Distribution of messages sent and active IP numbers for ASes in group 1. <strong>(a)</strong> CDF of the number of messages sent per AS. <strong>(b)</strong> CDF of the number of IP addresses per AS.</p>
</figcaption>
<p> 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size image</div>


The main characteristic of the ASes of this group is the small number of spamming machines, as we can see in Figure 3(b). Almost 60% of the Autonomous Systems here have only a single IP address in the dataset and none of them have more than one hundred IP addresses. This explains why that group, even encompassing 64% of the AS, is responsible for only 9.5% of the spam traffic generated. Furthermore, most of the IP addresses in this group are in XBL blacklist, which characterizes infected machines, probably belonging to botnets.</p>
<p>The activity period of the machines in the AS of this group show constant activity using the SMTP protocol in almost all ASes, as shown in Figure 4(a). On the other hand, the graph of Figure 4(c) shows that few ASes use the HTTP protocol and only one used this protocol for more than ten days. This large amount of messages sent by SMTP protocol, along with a high number of IP addresses in XBL, suggests the existence of bots. As there are few committed IP addresses in these AS, it is possible that those machines constitute exceptions in the security policy of an overall secure system and that, for some reason, go unnoticed to the management of these networks.</p>
<p>
  <img src="/img/neighborhood-spam_fig4.png" alt="Activity of Autonomous Systems in group 1, per protocol.">
</p>
<figcaption>
<p><strong>Figure 4</strong>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">figure4</div>


Activity of Autonomous Systems in group 1, per protocol. <strong>(a)</strong> SMTP. <strong>(b)</strong> SOCKS. <strong>(c)</strong> HTTP. ASes appear ordered in the y axis. There is a mark at position (x,y) if AS y was active on date x.</p>
</figcaption>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size image</div>


<h4 id="532-group-2">
  5.3.2 Group 2
  <a class="anchor" href="#532-group-2">#</a>
</h4>
<p>This group contains the ASes that sent more spam messages and together they are responsible for more than 65% of all messages. As shown in Figure 5(a), 5% of the ASes sent more than one million messages and are responsible for most of the spam traffic. In this group, almost no message is sent using the SMTP protocol, since 98% of the messages were sent by SOCKS and HTTP protocols.</p>
<p>
  <img src="/img/neighborhood-spam_fig5.png" alt="Distribution of messages sent and active IP numbers for ASes in group 2.">
</p>
<figcaption>
<p><strong>Figure 5</strong>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">figure5</div>


Distribution of messages sent and active IP numbers for ASes in group 2. <strong>(a)</strong> CDF of the number of messages sent per AS. <strong>(b)</strong> CDF of the number of IP addresses per AS.</p>
</figcaption>
<p> 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size image</div>


The Autonomous Systems in this group also have a small number of spamming IP addresses — 57% of them had only one IP address in the dataset. Moreover, a very small percentage of neighborhoods here (2%) have more than one hundred machines. However, even with a small number of IP addresses, the average number of spam messages sent by each of them is very large, more than 162 thousand, as can be seen in Table 5. Those features (few machines, with heavy spam traffic) suggest that most of the ASes here house machines that act as dedicated servers to send spam, probably with the connivance of the network administrators. In our opinion, an unwanted bot that would start behaving that way would not go unnoticed by a network administrator that did not accept such practice, and it would not remain limited to a few machines if the network administrator was careless enough not to bother about it. One final interesting aspect is that, in this group, most of the IP addresses are not in any blacklist. Considering the volume of traffic they generate, that would only be possible if they consistently abuse intermediary machines to hide from blacklist detection.</p>
<p>Compared to the other groups, the period of activity of the AS using SOCKS and HTTP protocols are higher in this group. We can see that there is a larger number of ASes and they remain active for a longer period, as the graphics of Figure 6 clearly shows.</p>
<p>
  <img src="/img/neighborhood-spam_fig6.png" alt="Activity of Autonomous Systems in group 2, per protocol.">
</p>
<figcaption>
<p><strong>Figure 6</strong>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">figure6</div>


Activity of Autonomous Systems in group 2, per protocol. <strong>(a)</strong> SMTP. <strong>(b)</strong> SOCKS. <strong>(c)</strong> HTTP. ASes appear ordered in the y axis. There is a mark at position (x,y) if AS y was active on date x.</p>
</figcaption>
<p> 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size image</div>


As mentioned earlier, ASes 10297, 29802 and 2497 were assigned to this group. Like others in the group, that were studied, those AS are characterized by offering hosting and co-location services, which would fit the profile just described.</p>
<h4 id="533-group-3">
  5.3.3 Group 3
  <a class="anchor" href="#533-group-3">#</a>
</h4>
<p>Table 5 shows that in this group, over 70% of spam messages were sent using the SMTP protocol and the ASes of the group are responsible for only 2.2% of all messages. The graph in Figure 7(a) shows that over 80% of the neighborhoods here sent less than 200,000 messages, explaining the fact that this group is responsible for a smaller number of messages.</p>
<p>
  <img src="/img/neighborhood-spam_fig7.png" alt="Distribution of messages sent and active IP numbers for ASes in group 3.">
</p>
<figcaption>
<p><strong>Figure 7</strong>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">figure7</div>


Distribution of messages sent and active IP numbers for ASes in group 3. <strong>(a)</strong> CDF of the number of messages sent per AS. <strong>(b)</strong> CDF of the number of IP addresses per AS.</p>
</figcaption>
<p> 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size image</div>


The graph in Figure 7(b) shows a similar behavior to that seen in groups 1 and 2, but the number of ASes with only one IP address is lower, just under 40%. What marks this group is the large number of IP addresses that use the SMTP protocol, over 99% of them, surpassing any other group. In addition, about 64% of the machines in this group are in XBL. This suggests the presence of bots, but the low number of IP addresses suggests that there are fewer compromised machines in those AS.</p>
<p>The graph in Figure 8(c) shows that only one AS of this group sent spam messages by HTTP protocol, and just for a short period of time. As expected, for the SMTP protocol, all the ASes were very active throughout the period, as seen in Figure 8(a).</p>
<p>
  <img src="/img/neighborhood-spam_fig8.png" alt="Activity of Autonomous Systems in group 3, per protocol.">
</p>
<figcaption>
<p><strong>Figure 8</strong>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">figure8</div>


Activity of Autonomous Systems in group 3, per protocol.<strong>(a)</strong> SMTP. <strong>(b)</strong> SOCKS. <strong>(c)</strong> HTTP. ASes appear ordered in the y axis. There is a mark at position (x,y) if AS y was active on date x.</p>
</figcaption>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size image</div>


<h4 id="534-group-4">
  5.3.4 Group 4
  <a class="anchor" href="#534-group-4">#</a>
</h4>
<p>From Figure 9(a) we can see that most of the ASes in this group used the SMTP protocol to send spam, but the few Autonomous Systems using SOCKS and HTTP protocols sent more than one million messages. The neighborhoods of this group are responsible for about 23% of all spam traffic.</p>
<p>
  <img src="/img/neighborhood-spam_fig9.png" alt="Distribution of messages sent and active IP numbers for ASes in group 4.">
</p>
<figcaption>
<p><strong>Figure 9</strong>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">figure9</div>


Distribution of messages sent and active IP numbers for ASes in group 4. <strong>(a)</strong> CDF of the number of messages sent per AS. <strong>(b)</strong> CDF of the number of IP addresses per AS.</p>
</figcaption>
<p> 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size image</div>


This group contains the ASes with the larger numbers of machines observed, as can be seen in Figure 9(b), with over 20% of neighborhoods with over 1,000 IP addresses, in which some of them have more than 100,000 machines. Thus, even accounting for much of the spam traffic, the number of spam messages per IP address is the lowest among the groups, only 3,000. Moreover, the great majority of the IP address are in blacklists and use the SMTP protocol. For all this, we have strong evidence that many of the machines belonging to this group are part of botnets. Because of the large number of machines in this situation, these AS are classified of bad neighborhoods, where, apparently, management policies and network maintenance are not able to prevent the proliferation of infected machines.</p>
<p>Because the ASes in this group have a very large number of IP addresses, it is common for the same AS to show the use of the three different protocols in the dissemination of spam. This behavior is explained by Figures 10(b) and 10(c). It was expected an intense period of activity in the use of the SMTP protocol, once machines belonging to botnets tend to use this protocol. Therefore, the graph of Figure 10(a) reinforces the suspicious about botnets.</p>
<p>
  <img src="/img/neighborhood-spam_fig10.png" alt="Activity of Autonomous Systems in group 4, per protocol.">
</p>
<figcaption>
<p><strong>Figure 10</strong>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">figure10</div>


Activity of Autonomous Systems in group 4, per protocol. <strong>(a)</strong> SMTP. <strong>(b)</strong> SOCKS. <strong>(c)</strong> HTTP. ASes appear ordered in the y axis. There is a mark at position (x,y) if AS y was active on date x.</p>
</figcaption>
<p> 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size image</div>


ASes 3462 and 4134, which are part of this group, have been classified as ISPs with DSL networks. This suggests that the composition of this group is predominantly domestic users machines infected by some type of malware.</p>
<h2 id="spambands-analysis">
  <em>SpamBands</em> analysis
  <a class="anchor" href="#spambands-analysis">#</a>
</h2>
<p>We applied the <em>SpamBand</em> identification algorithm described in Section 3 to the data from each honeypot. We found a total of 2618 <em>SpamBands</em> and the distribution of those among the honeypots is shown in Figure 11(a). This Figure reinforces the notion of orchestration by spammers: all honeypots have a well-defined range of <em>SpamBands</em> that attacked them each day, and the increase and decrease in the number of <em>SpamBands</em> in that interval suggests an orchestration in order to obfuscate the action of groups of spammers.</p>
<p>
  <img src="/img/neighborhood-spam_fig11.png" alt="SpamBands active in various honeypots over time.">
</p>
<figcaption>
<p><strong>Figure 11</strong>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">figure11</div>


SpamBands active in various honeypots over time. <strong>(a)</strong> The number of SpamBands found each day in eight different honeypots. <strong>(b)</strong> Their linear regressions.</p>
</figcaption>
<p> 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size image</div>


Figure 11(b) shows a linear regression of the number of <em>SpamBands</em> per day for each honeypot. The linear trends reveal lines with low inclination (almost constant) adding to the impression that the variation observed in Figure 11(a) is regular and is due to some kind of obfuscation. Another interesting result is about honeypot EC-01. That honeypot was attacked by more <em>SpamBands</em> than any other, although no clear reason for that was found.</p>
<p>Figure 12(a) shows that only 5% of <em>SpamBands</em> using SOCKS or HTTP have more than 100 IP addresses, again suggesting the use of dedicated infrastructure for sending messages. In contrast, about 30% of total <em>SpamBands</em> using SMTP have more than 100 IP addresses, which is not surprising, since these are supposed to be botnets that, in general, consist of a larger number of machines. Observing Figure 12(b), we see an inversion: HTTP or SOCKS <em>SpamBands</em> tend to send more messages than SMTP ones. This happens precisely due to the fact previously mentioned. Since those who use SOCKS or HTTP are probably dedicated servers, they use all their resources to send a large number of messages. On the other hand, those who use SMTP and are part of botnets can only send spam moderately, to avoid their identification [20].</p>
<p>
  <img src="/img/neighborhood-spam_fig12.png" alt="Distribution of IPs present and messages sent by SpamBands.">
</p>
<figcaption>
<p><strong>Figure 12</strong>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">figure12</div>


Distribution of IPs present and messages sent by SpamBands. <strong>(a)</strong> CDF of the number of IP addresses per SpamBand. <strong>(b)</strong> CDF of the number of messages sent per SpamBand.</p>
</figcaption>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size image</div>


<h3 id="relationship-between-spambands-and-ases">
  Relationship between SpamBands and ASes
  <a class="anchor" href="#relationship-between-spambands-and-ases">#</a>
</h3>
<p>In Figure 13, we can observe that the majority of <em>SpamBands</em>, for all protocols, have IP addresses from just a few ASes. This result indicates a topological relationship among IP addresses of a <em>SpamBand</em>, where machines from the same AS tend to send unwanted messages from the same set of spam campaigns. Furthermore, the small number of <em>SpamBands</em> that encompass IP addresses from more than 60 neighborhoods use the SMTP protocol. This result is expected, since SMTP is used by botnets, which tend to have infected machines spread over more ASes.</p>
<p>
  <img src="/img/neighborhood-spam_fig13.png" alt="Distribution of the number of AS per SpamBand.">
</p>
<figcaption>
<p><strong>Figure 13</strong>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">figure13</div>


Distribution of the number of AS per SpamBand. Show the distribution of the number of different AS that appears in a same SpamBand.</p>
</figcaption>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size image</div>


<h4 id="611-spambands-activities-in-different-neighborhoods">
  6.1.1 SpamBands activities in different neighborhoods
  <a class="anchor" href="#611-spambands-activities-in-different-neighborhoods">#</a>
</h4>
<p>As already mentioned, Autonomous Systems were classified in four groups, where groups 2 and 4 were considered bad neighborhoods. The results in the chart of Figure 14 shows that half of the <em>SpamBands</em> (about 50%) have IP addresses from Autonomous Systems that belong only to groups 2 or 4. Then come <em>SpamBands</em> that use both hosts in neighborhoods of type 2 and 4, and then those that use only group 1. This confirms that the ASes were classified correctly into those four groups and suggests that most of the IP addresses in <em>SpamBands</em> are in bad neighborhoods. Thus, this result points out that the efforts against the spam abuse have to focus in Autonomous Systems that are considered as bad neighborhoods.</p>
<p>
  <img src="/img/neighborhood-spam_fig14.png" alt="SpamBands distribution over neighborhood types (AS groups).">
</p>
<figcaption>
<p><strong>Figure 14</strong>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">figure14</div>


SpamBands distribution over neighborhood types (AS groups). Shows how SpamBands are distributed over neighborhood types (AS groups). The numbers on the x axis identify individual groups (1, 2, 3, 4) or combinations of two or three groups (<em>e.g.</em>, 24 means a SpamBand has members in ASes in neighborhood types identified by groups 2 and 4).</p>
</figcaption>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size image</div>


<p>Furthermore, most of <em>SpamBands</em> that contain AS from group 2 usually use the HTTP or SOCKS protocol. This was expected, once group 2 seems to have a lot of dedicated server machines to send spam. On the other hand, the <em>SpamBands</em> with AS in group 4 use the SMTP protocol. This result was also expected because most machines in these neighborhoods seems to belong to botnets.</p>
<h4 id="612-spambands-clustering">
  6.1.2 SpamBands clustering
  <a class="anchor" href="#612-spambands-clustering">#</a>
</h4>
<p>In this section we analyze the clustering coefficient inside the <em>SpamBands</em> to verify if IP addresses SpamBands interact more with other IP addresses in their AS than with IP addresses from others neighborhoods. The internal clustering coefficient (ICC) of a SpamBand is the average of the clustering coefficient in each AS considering only the internal connections, <em>i.e.</em>, connections among IP addresses that belong to a same Autonomous System. On the other hand, the external clustering coefficient (ECC) of a SpamBand takes the average of the clustering coefficient in each AS considering only the external connections, <em>i.e.</em>, connections among IP addresses of different Autonomous Systems.</p>
<p>As shown in Figure 15, 55% of the <em>SpamBands</em> have ICC higher than 0.3 while and only 42% have ECC higher than this value. Moreover, as we can see, the standard behavior is that each <em>SpamBand</em> have an ECC smaller than its ICC. We conclude that inside a <em>SpamBand</em>, the relationships between IP addresses which belong to a same AS are more intense. It suggests that there is a topological correlation among IP addresses inside a <em>SpamBand</em>, showing that Autonomous Systems are a good way to represent neighborhoods.</p>
<p>
  <img src="/img/neighborhood-spam_fig15.png" alt="SpamBands clustering within ASes.">
</p>
<figcaption>
<p><strong>Figure 15</strong>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">figure15</div>


SpamBands clustering within ASes. Verification of the clustering coefficient SpamBand graphs when considered the AS borders: average internal (within AS) and external (among ASes) clustering coefficientes.</p>
</figcaption>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">Full size image</div>


<h2 id="conclusions">
  Conclusions
  <a class="anchor" href="#conclusions">#</a>
</h2>
<p>Several efforts are under way to combat spam, but this task has been made difficult due to the technical sophistication of spammers. This paper tries to shed some light on the sources of spam messages, to help the development of techniques and policies to fight spam at its origin. Our results show that, although spam messages are being sent from various networks, most of the traffic is concentrated in a few Autonomous Systems, and that can be used to identify spam sources and fight them. Moreover, we grouped ASes into four categories based on their spam dissemination behavior. Those groups shown that we can identify good and bad neighborhoods, some with many infected machines, others with just a few on-and-off senders that get shut down quickly, other which are conniving with a few heavy spammers.</p>
<p>By identifying machines that participate together in a spam campaign (SpamBands), we observed that most campaigns originated from neighborhoods of a single type, or may include hosts in the two types of heavy sending neighborhoods at the same time. All that can be used to identify major sources of spam to help stop that kind of traffic.</p>
<p>As future work, we plan to conduct further analysis on each of the neighborhood categories found to better understand the differences among them. We also intend to better understand the behavior of the category considered good neighborhoods and check whether security policies used to define the behavior of those autonomous systems can serve as a model to others.</p>
<h2 id="references">
  References
  <a class="anchor" href="#references">#</a>
</h2>
<ol>
<li>
<p>Orman H (2013) The compleat story of phish. <em>Int Comput IEEE</em> 17(1): 87–91. 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">
MathSciNet

Article
 
Google Scholar</div>

</p>
</li>
<li>
<p>Newman MEJ, Forrest S, Balthrop J (2002) Email networks and the spread of computer viruses. <em>Phys Rev E</em> 66: 035101. 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">
Article
 
Google Scholar</div>

</p>
</li>
<li>
<p>Sipior JC, Ward BT, Bonner PG (2004) Should spam be on the menu? <em>Commun ACM</em> 47(6): 59–63. 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">
Article
 
Google Scholar</div>

</p>
</li>
<li>
<p>Guerra PHC, Guedes D, Wagner Meira J, Hoepers C, Chaves MHPC, Steding-Jessen K (2010) Exploring the spam arms race to characterize spam evolution In: <em>Proceedings of the 7th Collaboration, Electronic Messaging, Anti-Abuse and Spam Conference (CEAS)</em>, Redmond, WA.</p>
</li>
<li>
<p>van Wanrooij W, Pras A (2010) Filtering spam from bad neighborhoods. <em>Int J Netw Manag</em> 20(6): 433–444. 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">
Article
 
Google Scholar</div>

</p>
</li>
<li>
<p>Moreira Moura GC, Sadre R, Pras A (2011) Internet bad neighborhoods: the spam case. In: Festor O Lupu E (eds)7th International Conference on Network and Services Management (CNSM 2011), Paris, France, 1–8. <em>IEEE Communications Society</em>, USA. 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">
Google Scholar</div>

</p>
</li>
<li>
<p>Ramachandran A, Feamster N (2006) Understanding the Network-Level Behavior of Spammers. <em>SIGCOMM Comput Commun Rev</em> 36(4): 291–302. 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">
Article
 
Google Scholar</div>

</p>
</li>
<li>
<p>Duan Z, Gopalan K, Yuan X (2011) An empirical study of behavioral characteristics of spammers: Findings and implications. <em>Comput Commun</em> 34(14): 1764–1776. 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">
Article
 
Google Scholar</div>

</p>
</li>
<li>
<p>Pathak A, Hu YC, Mao ZM (2008) Peeking into spammer behavior from a unique vantage point In: <em>Proceedings of the 1st Usenix Workshop on Large-Scale Exploits and Emergent Threats</em>. LEET’08, 3–139. USENIX Association, Berkeley, CA, USA. <a href="http://dl.acm.org/citation.cfm?id=1387709.1387712">http://dl.acm.org/citation.cfm?id=1387709.1387712</a>.</p>
</li>
<li>
<p>Gomes LH, Almeida RB, Bettencourt LMA, Almeida V, Almeida JM (2005) Comparative Graph Theoretical Characterization of Networks of Spam and Legitimate Email In: <em>Proceedings of the Second Conference on Email and Anti-Spam - CEAS 2005</em>. CEAS, Stanford, CA, USA. 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">
Google Scholar</div>

</p>
</li>
<li>
<p>Kokkodis M, Faloutsos M (2009) Spamming botnets: Are we losing the war? In: <em>Proceedings of the 6th Conference on E-mail and Anti-spam (CEAS)</em>, Mountain View, CA.</p>
</li>
<li>
<p>Guerra PHC, Pires DEV, Guedes D, Wagner Meira J, Hoepers C, Steding-Jessen K (2008) A campaign-based characterization of spamming strategies In: <em>Proceedings of the 5th Conference on E-mail and Anti-spam (CEAS)</em>, Mountain View, CA.</p>
</li>
<li>
<p>Xie Y, Yu F, Achan K, Panigrahy R, Hulten G, Osipkov I (2008) Spamming botnets: signatures and characteristics. In: Bahl V, Wetherall D, Savage S, Stoica I (eds) <em>SIGCOMM</em>, 171–182.. ACM, Seatle, WA. 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">
Google Scholar</div>

</p>
</li>
<li>
<p>Fonseca O, Las-Casas PHB, Fazzion E, Guedes D, Jr. WM, Hoepers C, Steding-Jessen K, Chaves MHP (2014) Vizinhanças ou condomínios: uma análise da origem de spams com base na organização de sistemas autônomos In: <em>Brazilian Symposium on Computer Networks and Distributed Systems (SBRC)</em> (In Portuguese), Florianópolis, Brazil.</p>
</li>
<li>
<p>Fazzion E, Las-Casas PHB, Fonseca O, Guedes D, Jr. WM, Hoepers C, Steding-Jessen K, Chaves MHP (2014) Spambands: Uma metodologia para identificação de fontes de spam agindo sob uma coordenação In: <em>Brazilian Symposium on Information Security and Computer Systems (SBSeg)</em> (In Portuguese), Belo Horizonte, Brazil.</p>
</li>
<li>
<p>Steding-jessen K, Vijaykumar NL, Montes A (2008) Using Low-Interaction Honeypots to Study the Abuse of Open Proxies to Send Spam. <em>INFOCOMP J Comput Sci</em> 7(1): 45–53. 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">
Google Scholar</div>

</p>
</li>
<li>
<p>Totti LC, Moreira REA, Fazzion E, Fonseca O, Wagner Meira J, Guedes D, Hoepers C, Steding-Jessen K, Chaves MHP (2012) Impacto da Evolução Temporal na Detecção de Spammers na Rede de Origem In: <em>SBRC</em> 2012, Ouro Preto, Brasil.</p>
</li>
<li>
<p>Almeida H, Guedes D, Meira W, Zaki MJ (2011) Is there a best quality metric for graph clusters? In: <em>Proceedings of the 2011 European Conference on Machine Learning and Knowledge Discovery in Databases</em> - Volume Part I, 44–59, Athens, Greece.</p>
</li>
<li>
<p>Pelleg D, Moore AW (2000) X-means: Extending k-means with efficient estimation of the number of clusters In: <em>ICML</em>, 727–734, San Francisco, CA.</p>
</li>
<li>
<p>John JP, Moshchuk A, Gribble SD, Krishnamurthy A (2009) Studying Spamming Botnets Using Botlab In: <em>6th USENIX Symp. on Networked Systems Design and Implementation</em>, Boston, EUA.</p>
</li>
</ol>
<h3 id="download-references">
  Download references
  <a class="anchor" href="#download-references">#</a>
</h3>
<h2 id="acknowledgments">
  Acknowledgments
  <a class="anchor" href="#acknowledgments">#</a>
</h2>
<p>This work was partially funded by NIC.Br, Fapemig, CAPES, CNPq and InWeb.</p>
<h2 id="author-information">
  Author information
  <a class="anchor" href="#author-information">#</a>
</h2>
<h3 id="affiliations">
  Affiliations
  <a class="anchor" href="#affiliations">#</a>
</h3>
<p>Department of Computer Science, Universidade Federal de Minas Gerais, Belo Horizonte, Brazil
Osvaldo Fonseca, Elverton Fazzion, Pedro Henrique B Las-Casas, Dorgival Guedes &amp; Wagner Meira Jr</p>
<p>Brazilian Emergency Response Team (CERT.br), Brazilian Network Information Center (NIC.br), São Paulo, Brazil
Cristine Hoepers, Klaus Steding-Jessen &amp; Marcelo HP Chaves</p>
<h3 id="corresponding-author">
  Corresponding author
  <a class="anchor" href="#corresponding-author">#</a>
</h3>
<p>Correspondence to Osvaldo Fonseca.</p>
<h2 id="additional-information">
  Additional information
  <a class="anchor" href="#additional-information">#</a>
</h2>
<h3 id="competing-interests">
  Competing interests
  <a class="anchor" href="#competing-interests">#</a>
</h3>
<p>The authors declare that they have no competing interests.</p>
<h3 id="authors-contributions">
  Authors’ contributions
  <a class="anchor" href="#authors-contributions">#</a>
</h3>
<p>OF carried out the Neighborhood analysis, participated in the SpamBand analysis, and drafted part of the manuscript. PHBLC participated in the SpamBand and Neighborhood analysis, and drafted part of the manuscript. EF carried out the SpamBand analysis and helped draft the manuscript. DG and WM participated in the design of the study and coordinated it, guided the analysis and helped draft the manuscript. CH, KSJ and MHPC built the collection infrastructure, provided the dataset and participated in the analysis. All authors read and approved the final manuscript.</p>
<h2 id="rights-and-permissions">
  Rights and permissions
  <a class="anchor" href="#rights-and-permissions">#</a>
</h2>
<p>Open Access This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<a href="https://creativecommons.org/licenses/by/4.0%29">https://creativecommons.org/licenses/by/4.0)</a>, which permits use, duplication, adaptation, distribution, and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</p>
<h2 id="reprints-and-permissions">
  Reprints and Permissions
  <a class="anchor" href="#reprints-and-permissions">#</a>
</h2>
<h3 id="about-this-article">
  About this article
  <a class="anchor" href="#about-this-article">#</a>
</h3>
<p>Verify currency and authenticity via CrossMark</p>
<h3 id="cite-this-article">
  Cite this article
  <a class="anchor" href="#cite-this-article">#</a>
</h3>
<p>Fonseca, O., Fazzion, E., B Las-Casas, P.H. et al. Neighborhoods and bands: an analysis of the origins of spam. J Internet Serv Appl 6, 9 (2015). <a href="https://doi.org/10.1186/s13174-015-0025-5">https://doi.org/10.1186/s13174-015-0025-5</a></p>
<p>Download citation</p>
<p>Received
17 September 2014</p>
<p>Accepted
29 March 2015</p>
<p>Published
11 May 2015</p>
<p>DOI
<a href="https://doi.org/10.1186/s13174-015-0025-5">https://doi.org/10.1186/s13174-015-0025-5</a></p>
<h3 id="share-this-article">
  Share this article
  <a class="anchor" href="#share-this-article">#</a>
</h3>
<p>Anyone you share the following link with will be able to read this content:</p>
<h3 id="get-shareable-link">
  Get shareable link
  <a class="anchor" href="#get-shareable-link">#</a>
</h3>
<p>Provided by the Springer Nature SharedIt content-sharing initiative</p>
<h2 id="keywords">
  Keywords
  <a class="anchor" href="#keywords">#</a>
</h2>
<p>Spam traffic
Autonomous system
Network bad neighborhoods</p>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">
Download PDF</br>
Sections</br>
Figures</br>
References</br>
Abstract</br>
Introduction</br>
Related work</br>
Methodology</br>
Collected data</br>
Neighborhood analysis</br>
SpamBands analysis</br>
Conclusions</br>
References</br>
Acknowledgments</br>
Author information</br>
Additional information</br>
Rights and permissions</br>
About this article</br>
Advertisement</br>
Support and Contact</br>
Jobs</br>
Language editing for authors</br>
Scientific editing for authors</br>
Leave feedback</br>
Terms and conditions</br>
Privacy statement</br>
Accessibility</br>
Cookies</br>
Follow SpringerOpen</div>


<p>Submit your manuscript to a SpringerOpen journal and benefit from:</p>
<ul>
<li>Convenient online submission</li>
<li>Rigorous peer review</li>
<li>Immediate publication on acceptance</li>
<li>Open access: articles freely available online</li>
<li>High visibility within the field</li>
<li>Retaining the copyright to your article</li>
</ul>
<p>Submit your next manuscript at springeropen.com</p>
 




<link href="https://fonts.googleapis.com/css?family=Rubik+Iso" rel="stylesheet" type="text/css">

<div style="font-family:'Rubik Iso'; font-size:10pt; font-style:normal; color:normal; font-weight:normal">
SpringerOpen Twitter page</br>
SpringerOpen Facebook page</br>
By using this website, you agree to our Terms and Conditions, California Privacy Statement, Privacy statement and Cookies policy. Manage cookies/Do not sell my data we use in the preference centre.
</div>


<p>Springer Nature
© 2021 BioMed Central Ltd unless otherwise stated. Part of Springer Nature.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Department of Computer Science, Universidade Federal de Minas Gerais, Belo Horizonte, Brazil&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref1:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref2:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref3:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref4:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref5:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Brazilian Emergency Response Team (CERT.br) Brazilian Network Information Center (NIC.br), São Paulo, Brazil.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref1:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#abstract">Abstract</a></li>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#related-work">Related work</a></li>
    <li><a href="#methodology">Methodology</a>
      <ul>
        <li><a href="#collection-infrastructure">Collection infrastructure</a></li>
        <li><a href="#spam-campaigns-and-spam-bands">Spam campaigns and spam bands</a></li>
      </ul>
    </li>
    <li><a href="#collected-data">Collected data</a></li>
    <li><a href="#neighborhood-analysis">Neighborhood analysis</a>
      <ul>
        <li><a href="#distribution-of-ip-addresses-in-autonomous-systems">Distribution of IP addresses in autonomous systems</a></li>
        <li><a href="#analysis-of-neighborhoods-with-higher-transmission-power">Analysis of neighborhoods with higher transmission power</a></li>
        <li><a href="#grouping-of-autonomous-systems">Grouping of autonomous systems</a></li>
      </ul>
    </li>
    <li><a href="#spambands-analysis"><em>SpamBands</em> analysis</a>
      <ul>
        <li><a href="#relationship-between-spambands-and-ases">Relationship between SpamBands and ASes</a></li>
      </ul>
    </li>
    <li><a href="#conclusions">Conclusions</a></li>
    <li><a href="#references">References</a>
      <ul>
        <li><a href="#download-references">Download references</a></li>
      </ul>
    </li>
    <li><a href="#acknowledgments">Acknowledgments</a></li>
    <li><a href="#author-information">Author information</a>
      <ul>
        <li><a href="#affiliations">Affiliations</a></li>
        <li><a href="#corresponding-author">Corresponding author</a></li>
      </ul>
    </li>
    <li><a href="#additional-information">Additional information</a>
      <ul>
        <li><a href="#competing-interests">Competing interests</a></li>
        <li><a href="#authors-contributions">Authors’ contributions</a></li>
      </ul>
    </li>
    <li><a href="#rights-and-permissions">Rights and permissions</a></li>
    <li><a href="#reprints-and-permissions">Reprints and Permissions</a>
      <ul>
        <li><a href="#about-this-article">About this article</a></li>
        <li><a href="#cite-this-article">Cite this article</a></li>
        <li><a href="#share-this-article">Share this article</a></li>
        <li><a href="#get-shareable-link">Get shareable link</a></li>
      </ul>
    </li>
    <li><a href="#keywords">Keywords</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












